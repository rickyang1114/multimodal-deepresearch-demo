<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sustainable Office Infrastructure</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 0;
            background-color: #ffffff;
        }
        
        .visualization-container {
            width: 1000px;
            height: 900px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .title {
            text-align: center;
            color: #002D5A;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
            width: 100%;
        }
        
        .subtitle {
            text-align: center;
            color: #4A4A4A;
            font-size: 16px;
            margin-bottom: 20px;
            width: 100%;
        }
        
        .source {
            text-align: center;
            font-style: italic;
            font-size: 12px;
            color: #666;
            margin-top: 15px;
            width: 100%;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-top: 20px;
            width: 100%;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 3px;
        }
        
        .svg-container {
            width: 900px;
            height: 700px;
            margin: 0 auto;
        }
        
        .center-text {
            font-weight: bold;
            fill: white;
            text-anchor: middle;
            text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .category-text {
            font-weight: bold;
            fill: white;
            text-anchor: middle;
            text-shadow: 0px 1px 3px rgba(0, 0, 0, 0.7);
        }
        
        .feature-text {
            font-size: 11px;
            fill: #333;
            text-anchor: middle;
            font-weight: bold;
        }
        
        .feature-circle {
            stroke: white;
            stroke-width: 2;
        }
    </style>
</head>
<body>
    <div class="visualization-container">
        <div class="title">Sustainable Office Infrastructure: Key Components for Future Workplaces</div>
        <div class="subtitle">Integrated sustainability features becoming standard by 2025</div>
        
        <div class="svg-container" id="chart"></div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #2E7D32;"></div>
                <span>Current standard practice</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4CAF50;"></div>
                <span>Implementation by 2025</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #8BC34A;"></div>
                <span>Emerging technology</span>
            </div>
        </div>
        
        <div class="source">Source: Framery's 2025 Work Trends Report (2024), Office Principles (2023)</div>
    </div>

    <script>
        // SVG setup
        const svg = d3.select("#chart")
            .append("svg")
            .attr("width", 900)
            .attr("height", 700)
            .append("g")
            .attr("transform", "translate(450, 350)");
        
        const width = 900;
        const height = 700;
        const radius = Math.min(width, height) / 2.5;
        
        // Define categories with their features and icons
        const categories = [
            {
                name: "Energy Systems",
                color: "#FF9800",
                features: [
                    { name: "Solar panels", icon: "fa-solar-panel", status: "current" },
                    { name: "Green roofs", icon: "fa-seedling", status: "by2025" },
                    { name: "Smart energy storage", icon: "fa-battery-full", status: "emerging" }
                ]
            },
            {
                name: "Building Materials",
                color: "#795548",
                features: [
                    { name: "Low-VOC paints", icon: "fa-paint-roller", status: "current" },
                    { name: "Non-toxic furniture", icon: "fa-couch", status: "current" },
                    { name: "Recycled materials", icon: "fa-recycle", status: "by2025" }
                ]
            },
            {
                name: "Biophilia & Air Quality",
                color: "#4CAF50",
                features: [
                    { name: "Living walls", icon: "fa-leaf", status: "by2025" },
                    { name: "Native landscaping", icon: "fa-tree", status: "current" },
                    { name: "Advanced air filtration", icon: "fa-wind", status: "emerging" }
                ]
            },
            {
                name: "Smart Building Technology",
                color: "#2196F3",
                features: [
                    { name: "Motion-activated lighting", icon: "fa-lightbulb", status: "current" },
                    { name: "HVAC optimization", icon: "fa-temperature-low", status: "by2025" },
                    { name: "Occupancy sensors", icon: "fa-user", status: "by2025" }
                ]
            },
            {
                name: "Water Conservation",
                color: "#03A9F4",
                features: [
                    { name: "Rainwater harvesting", icon: "fa-cloud-rain", status: "by2025" },
                    { name: "Low-flow fixtures", icon: "fa-faucet", status: "current" },
                    { name: "Gray water systems", icon: "fa-water", status: "emerging" }
                ]
            },
            {
                name: "Transportation Support",
                color: "#673AB7",
                features: [
                    { name: "Bike storage", icon: "fa-bicycle", status: "current" },
                    { name: "EV charging stations", icon: "fa-charging-station", status: "by2025" },
                    { name: "Carpooling incentives", icon: "fa-car-side", status: "emerging" }
                ]
            }
        ];
        
        // Status colors
        const statusColors = {
            "current": "#2E7D32",  // Dark green
            "by2025": "#4CAF50",   // Medium green
            "emerging": "#8BC34A"  // Light green
        };
        
        // Create central circle
        svg.append("circle")
            .attr("cx", 0)
            .attr("cy", 0)
            .attr("r", radius * 0.25)
            .attr("fill", "#2E7D32")
            .attr("stroke", "white")
            .attr("stroke-width", 3);
        
        // Add central text (split into multiple lines for better readability)
        svg.append("text")
            .attr("class", "center-text")
            .attr("x", 0)
            .attr("y", -15)
            .attr("font-size", "16px")
            .text("Sustainable");
            
        svg.append("text")
            .attr("class", "center-text")
            .attr("x", 0)
            .attr("y", 10)
            .attr("font-size", "16px")
            .text("Office");
            
        svg.append("text")
            .attr("class", "center-text")
            .attr("x", 0)
            .attr("y", 35)
            .attr("font-size", "16px")
            .text("Infrastructure");
        
        // Create pie layout
        const pie = d3.pie()
            .value(1)
            .padAngle(0.04);
            
        // Create arc for segments
        const arc = d3.arc()
            .innerRadius(radius * 0.3)
            .outerRadius(radius * 0.6);
        
        // Add segments for each category
        svg.selectAll(".category-segment")
            .data(pie(categories))
            .enter()
            .append("path")
            .attr("d", arc)
            .attr("fill", d => d.data.color)
            .attr("stroke", "white")
            .attr("stroke-width", 2);
        
        // Add category labels
        svg.selectAll(".category-label")
            .data(pie(categories))
            .enter()
            .append("text")
            .attr("class", "category-text")
            .attr("transform", d => {
                const centroid = arc.centroid(d);
                // Position text at 85% of the way from center to outer edge
                return `translate(${centroid[0] * 0.85}, ${centroid[1] * 0.85})`;
            })
            .attr("font-size", "14px")
            .attr("dy", d => {
                // Adjust vertical position based on category name length
                if (d.data.name.includes(" ")) {
                    return "0.3em";
                }
                return "0.35em";
            })
            .each(function(d) {
                const text = d3.select(this);
                const words = d.data.name.split(' ');
                
                if (words.length > 1) {
                    // For multi-word categories, split into lines
                    text.text('');
                    
                    if (words.length === 2) {
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "-0.6em")
                            .text(words[0]);
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "1.2em")
                            .text(words[1]);
                    } else if (words.length === 3) {
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "-1.2em")
                            .text(words[0]);
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "1.2em")
                            .text(words[1]);
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "1.2em")
                            .text(words[2]);
                    } else if (words.length === 4) {
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "-1.2em")
                            .text(words[0] + " " + words[1]);
                        text.append("tspan")
                            .attr("x", 0)
                            .attr("dy", "1.2em")
                            .text(words[2] + " " + words[3]);
                    }
                } else {
                    text.text(d.data.name);
                }
            });
        
        // Calculate feature positions more carefully to avoid overlap
        categories.forEach((category, i) => {
            // Calculate the middle angle of this segment
            const angle = (i * 2 * Math.PI / categories.length) + (Math.PI / categories.length);
            
            // Calculate positions for features with better spacing
            const featurePositions = [];
            const featureCount = category.features.length;
            
            // Adjust spacing based on number of features
            const spacingFactor = featureCount === 3 ? 0.13 : 0.15;
            
            for (let j = 0; j < featureCount; j++) {
                // Calculate position with better spacing between features
                const featureRadius = radius * 0.75 + (j * radius * spacingFactor);
                
                // Add slight angular offset for better distribution
                const featureAngle = angle + (j - (featureCount - 1) / 2) * 0.15;
                
                const x = featureRadius * Math.sin(featureAngle);
                const y = -featureRadius * Math.cos(featureAngle);
                
                featurePositions.push({ x, y });
            }
            
            // Add each feature for this category with calculated positions
            category.features.forEach((feature, j) => {
                const { x, y } = featurePositions[j];
                
                // Add feature circle with appropriate color
                svg.append("circle")
                    .attr("class", "feature-circle")
                    .attr("cx", x)
                    .attr("cy", y)
                    .attr("r", 25) // Slightly smaller circles
                    .attr("fill", statusColors[feature.status]);
                
                // Add feature icon using Font Awesome
                svg.append("foreignObject")
                    .attr("x", x - 12)
                    .attr("y", y - 12)
                    .attr("width", 24)
                    .attr("height", 24)
                    .html(`<div style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: white;">
                        <i class="fas ${feature.icon}" style="font-size: 14px;"></i>
                    </div>`);
                
                // Add feature text below the circle with better positioning
                // Shortened feature names to prevent overlap
                const textY = y + 40; // Position text further from circle
                
                svg.append("text")
                    .attr("class", "feature-text")
                    .attr("x", x)
                    .attr("y", textY)
                    .attr("text-anchor", "middle")
                    .text(feature.name);
            });
        });
        
        // Add connecting lines from center to each category
        svg.selectAll(".connector")
            .data(pie(categories))
            .enter()
            .append("line")
            .attr("x1", d => {
                const centroid = arc.centroid(d);
                return centroid[0] * 0.3; // Start from inner radius
            })
            .attr("y1", d => {
                const centroid = arc.centroid(d);
                return centroid[1] * 0.3; // Start from inner radius
            })
            .attr("x2", d => {
                const centroid = arc.centroid(d);
                return centroid[0] * 0.6; // End at outer radius
            })
            .attr("y2", d => {
                const centroid = arc.centroid(d);
                return centroid[1] * 0.6; // End at outer radius
            })
            .attr("stroke", "white")
            .attr("stroke-width", 2)
            .attr("opacity", 0.7);
    </script>
</body>
</html>