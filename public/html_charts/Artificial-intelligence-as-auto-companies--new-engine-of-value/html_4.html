<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generative AI Productivity Gains in Automotive Software Development</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .title {
            font-size: 16pt;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 14pt;
            color: #555;
            margin-bottom: 20px;
        }
        
        .section-header {
            font-size: 14pt;
            font-weight: bold;
            padding: 8px 10px;
            background-color: #f5f5f5;
            margin-top: 15px;
            margin-bottom: 10px;
        }
        
        .activity-label {
            font-size: 12pt;
        }
        
        .bar-value {
            font-family: 'Georgia', serif;
            font-size: 13pt;
            font-weight: bold;
            fill: white;
            text-shadow: 0px 0px 3px rgba(0, 0, 0, 0.3);
        }
        
        .source {
            font-size: 10pt;
            color: #666;
            margin-top: 20px;
        }
        
        .grid line {
            stroke: #e0e0e0;
            stroke-opacity: 0.7;
            shape-rendering: crispEdges;
        }
        
        .grid path {
            stroke-width: 0;
        }
        
        .tick text {
            font-size: 11pt;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Generative AI Productivity Gains in Automotive Software Development</div>
        <div class="subtitle">Average time savings by role and activity</div>
        <div id="chart"></div>
        <div class="source">Source: McKinsey Center for Future Mobility, 2024</div>
    </div>

    <script>
        // Data preparation
        const data = [
            { section: "Product Management", activity: "Requirements Drafting", value: 39 },
            { section: "Product Management", activity: "User Story Creation", value: 28 },
            { section: "Product Management", activity: "Documentation", value: 25 },
            { section: "Product Management", activity: "Feature Planning", value: 18 },
            { section: "Product Management", activity: "Backlog Management", value: 10 },
            { section: "Development & QA", activity: "QA Productivity", value: 44 },
            { section: "Development & QA", activity: "Code Generation", value: 40 },
            { section: "Development & QA", activity: "Code Refactoring", value: 35 },
            { section: "Development & QA", activity: "Documentation", value: 32 },
            { section: "Development & QA", activity: "Debugging", value: 20 }
        ];

        // Dimensions - adjusted for better fit
        const margin = { top: 20, right: 50, bottom: 30, left: 180 };
        const width = 900 - margin.left - margin.right;
        const height = 550 - margin.top - margin.bottom;
        const barHeight = 25;
        const barPadding = 10;
        const sectionPadding = 30;

        // Create SVG
        const svg = d3.select("#chart")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left}, ${margin.top})`);

        // Create gradients
        const defs = svg.append("defs");
        
        // Product Management gradient
        const pmGradient = defs.append("linearGradient")
            .attr("id", "pmGradient")
            .attr("x1", "0%")
            .attr("y1", "0%")
            .attr("x2", "100%")
            .attr("y2", "0%");
            
        pmGradient.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", "#A9D6E5");
            
        pmGradient.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", "#00B5AD");
        
        // Development & QA gradient - adjusted to be slightly lighter for better text readability
        const devGradient = defs.append("linearGradient")
            .attr("id", "devGradient")
            .attr("x1", "0%")
            .attr("y1", "0%")
            .attr("x2", "100%")
            .attr("y2", "0%");
            
        devGradient.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", "#A9D6E5");
            
        devGradient.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", "#1A4B7C"); // Slightly lighter than before for better text contrast

        // X scale
        const x = d3.scaleLinear()
            .domain([0, 45])
            .range([0, width]);

        // X axis
        svg.append("g")
            .attr("transform", `translate(0, ${height})`)
            .call(d3.axisBottom(x)
                .ticks(9)
                .tickFormat(d => d + "%"))
            .selectAll("text")
            .style("text-anchor", "middle");

        // Gridlines
        svg.append("g")
            .attr("class", "grid")
            .call(d3.axisBottom(x)
                .ticks(9)
                .tickSize(-height)
                .tickFormat(""))
            .attr("transform", `translate(0, ${height})`);

        // Process data to calculate positions
        let sections = Array.from(new Set(data.map(d => d.section)));
        let yPosition = 0;
        let sectionPositions = {};
        let activityPositions = {};

        sections.forEach(section => {
            sectionPositions[section] = yPosition;
            yPosition += 40; // Space for section header
            
            let sectionData = data.filter(d => d.section === section);
            sectionData.forEach((d, i) => {
                activityPositions[d.activity + "_" + d.section] = yPosition; // Added section to key to handle duplicate activity names
                yPosition += barHeight + barPadding;
            });
            
            yPosition += sectionPadding - barPadding; // Add padding between sections
        });

        // Section headers
        sections.forEach(section => {
            // Background for section header
            svg.append("rect")
                .attr("x", -margin.left)
                .attr("y", sectionPositions[section] - 5)
                .attr("width", width + margin.left + margin.right)
                .attr("height", 30)
                .attr("fill", "#f5f5f5")
                .attr("rx", 3)
                .attr("ry", 3)
                .lower();
                
            svg.append("text")
                .attr("class", "section-header")
                .attr("x", -margin.left + 10)
                .attr("y", sectionPositions[section])
                .attr("dy", "0.8em")
                .text(section);
        });

        // Activity labels
        data.forEach(d => {
            svg.append("text")
                .attr("class", "activity-label")
                .attr("x", -10)
                .attr("y", activityPositions[d.activity + "_" + d.section] + barHeight / 2)
                .attr("text-anchor", "end")
                .attr("dominant-baseline", "middle")
                .text(d.activity);
        });

        // Bars
        data.forEach(d => {
            // Determine gradient based on section
            const gradientId = d.section === "Product Management" ? "pmGradient" : "devGradient";
            
            // Draw bar
            svg.append("rect")
                .attr("x", 0)
                .attr("y", activityPositions[d.activity + "_" + d.section])
                .attr("width", x(d.value))
                .attr("height", barHeight)
                .attr("rx", 3)
                .attr("ry", 3)
                .attr("fill", `url(#${gradientId})`);
                
            // Calculate position for percentage text - adjusted to be more consistent
            // For higher values, position further from the edge
            const textPadding = 25; // Consistent padding from right edge
            const textX = x(d.value) - textPadding;
            
            // Value inside bar
            svg.append("text")
                .attr("class", "bar-value")
                .attr("x", textX)
                .attr("y", activityPositions[d.activity + "_" + d.section] + barHeight / 2)
                .attr("dominant-baseline", "middle")
                .attr("text-anchor", "middle")
                .text(d.value + "%");
        });
    </script>
</body>
</html>