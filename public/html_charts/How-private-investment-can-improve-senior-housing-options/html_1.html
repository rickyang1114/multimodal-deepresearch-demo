<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U.S. Senior Housing Market: Segments and Key Metrics</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 0;
            background-color: #ffffff;
        }
        
        .visualization-container {
            width: 800px;
            height: 500px;
            display: flex;
            flex-direction: column;
            padding: 0;
        }
        
        .title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ddd;
        }
        
        th {
            background-color: #708090;
            color: white;
            font-weight: bold;
            padding: 12px 15px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        td {
            padding: 10px 15px;
            border: 1px solid #ddd;
        }
        
        tr:nth-child(even) {
            background-color: #F5F5F5;
        }
        
        tr:nth-child(odd) {
            background-color: white;
        }
        
        .segment-name {
            font-weight: bold;
            text-align: left;
        }
        
        .value {
            text-align: right;
        }
        
        .na-value {
            text-align: right;
            font-style: italic;
            color: #999;
        }
        
        .key-number {
            font-family: 'Georgia', serif;
            font-size: 16px;
            color: #2c3e50;
            font-weight: bold;
        }
        
        .footnote {
            margin-top: 15px;
            font-size: 12px;
            color: #777;
        }
        
        .source {
            margin-top: 5px;
            font-size: 11px;
            color: #777;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="visualization-container">
        <div class="title">U.S. Senior Housing Market: Segments and Key Metrics</div>
        
        <div id="table-container"></div>
        
        <div class="footnote">Cap-rate spreads vs conventional apartments tightened from 300 bps to ~150-175 bps.</div>
        <div class="source">Source: Lynn & Wang, 2017</div>
    </div>

    <script>
        // Data for the table
        const data = [
            {
                segment: "Active Adult & Senior Apartments",
                margins: "N/A",
                rentGrowth: "4-5%",
                capRates: "N/A"
            },
            {
                segment: "Independent Living Facilities (ILFs)",
                margins: ">40%",
                rentGrowth: "4-5%",
                capRates: "~7.4%"
            },
            {
                segment: "Assisted Living Facilities (ALFs, including memory care)",
                margins: ">30%",
                rentGrowth: "4-5%",
                capRates: "~9.0%"
            },
            {
                segment: "Skilled Nursing Facilities (SNFs)",
                margins: "N/A",
                rentGrowth: "N/A",
                capRates: "N/A"
            },
            {
                segment: "Continuing Care Retirement Communities (CCRCs)",
                margins: "Varies by level",
                rentGrowth: "4-5%",
                capRates: "Varies by level"
            }
        ];

        // Column headers
        const columns = [
            { key: "segment", label: "Segment" },
            { key: "margins", label: "Operating Margins" },
            { key: "rentGrowth", label: "Annual Rent Growth" },
            { key: "capRates", label: "Cap Rates (Q3 2007)" }
        ];

        // Create table using D3.js
        const table = d3.select("#table-container")
            .append("table");

        // Add table header
        const thead = table.append("thead");
        thead.append("tr")
            .selectAll("th")
            .data(columns)
            .enter()
            .append("th")
            .text(d => d.label);

        // Add table body
        const tbody = table.append("tbody");
        const rows = tbody.selectAll("tr")
            .data(data)
            .enter()
            .append("tr");

        // Add cells to each row
        rows.selectAll("td")
            .data(row => {
                return columns.map(column => {
                    return { 
                        column: column.key, 
                        value: row[column.key],
                        isNA: row[column.key] === "N/A",
                        isKeyNumber: (
                            (column.key === "margins" && (row[column.key] === ">40%" || row[column.key] === ">30%")) ||
                            (column.key === "capRates" && (row[column.key] === "~7.4%" || row[column.key] === "~9.0%"))
                        )
                    };
                });
            })
            .enter()
            .append("td")
            .attr("class", d => {
                if (d.column === "segment") return "segment-name";
                return d.isNA ? "na-value" : "value";
            })
            .html(d => {
                if (d.isNA) return "N/A";
                
                // Highlight key numbers with proper styling
                if (d.isKeyNumber) {
                    return `<span class="key-number">${d.value}</span>`;
                }
                
                return d.value;
            });
    </script>
</body>
</html>